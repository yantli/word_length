knitr::opts_chunk$set(echo = TRUE)
cor(physical)
model4 <- lm(formula = HeadCirc ~ LeftFoot + RtFoot, data = physical)
summary(model4)
model6 <- lm(formula = HeadCirc ~ LeftFoot + hat, data = physical)
summary(model6)
VIF(model6)
vif(model6)
```{r}
library(car)
library(MASS)
library(leaps)
vif(model6)
vif(model4)
vif(model6)
model6 <- lm(formula = HeadCirc ~ LeftFoot + I(LeftFoot^2), data = physical)
summary(model6)
vif(model6)
model4 <- lm(formula = HeadCirc ~ LeftFoot + RtFoot, data = physical)
summary(model4)
model6 <- lm(formula = HeadCirc ~ 1, data = physical)
summary(model6)
anova(model6, model4)
library(tidyverse)
get_cooccurrence_tokens3 <- function(corpus, set1, set2) {
root_list <- c()
data = read.table(corpus, header = FALSE)[[1]]
for (root in data) {
for (element in set1) {
if(str_detect(root, element)) {
for (element in set2) {
if (str_detect(root, element)) {
if (!(root %in% root_list)) {
root_list <- append(root_list, root)
}
}
}
}
}
}
return(root_list)
}
get_cooccurrence_proportion <- function(corpus, set1, set2){
data = read_csv(corpus, col_names = FALSE)
num_of_roots = length(data$X1)
num_of_disharm_roots = length(get_cooccurrence_tokens2(corpus, set1, set2))
proportion = num_of_disharm_roots / num_of_roots
return(proportion)
}
Finnish_prop = get_cooccurrence_proportion("http://socsci.uci.edu/~cjmayer/teaching/LSCI_202A/finnish.txt",
c("y", "ö", "ä"),
c("u", "o", "a"))
get_cooccurrence_proportion <- function(corpus, set1, set2){
data = read_csv(corpus, col_names = FALSE)
num_of_roots = length(data$X1)
num_of_disharm_roots = length(get_cooccurrence_tokens(corpus, set1, set2))
proportion = num_of_disharm_roots / num_of_roots
return(proportion)
}
Finnish_prop = get_cooccurrence_proportion("http://socsci.uci.edu/~cjmayer/teaching/LSCI_202A/finnish.txt",
c("y", "ö", "ä"),
c("u", "o", "a"))
get_cooccurrence_proportion <- function(corpus, set1, set2){
data = read_csv(corpus, col_names = FALSE)
num_of_roots = length(data$X1)
num_of_disharm_roots = length(get_cooccurrence_tokens3(corpus, set1, set2))
proportion = num_of_disharm_roots / num_of_roots
return(proportion)
}
Finnish_prop = get_cooccurrence_proportion("http://socsci.uci.edu/~cjmayer/teaching/LSCI_202A/finnish.txt",
c("y", "ö", "ä"),
c("u", "o", "a"))
Uyghur_prop = get_cooccurrence_proportion("http://socsci.uci.edu/~cjmayer/teaching/LSCI_202A/uyghur.txt",
c("ü", "ö", "e"),
c("u", "o", "a"))
print(Finnish_prop)
print(Uyghur_prop)
library(tidyverse)
library(dplyr)
library(showtext)
showtext_auto()
library(lme4)
library(lmerTest)
library(ggplot2)
library(poolr)
library(ggrepel)
stats <- read.csv(file = "/Users/yanting/Desktop/word_length/probs/stats.csv")
stats$stat <- as.numeric(stats$stat)
stats %>% filter(test == "glmer", parameter %in% c("beta", "p"), context_char %in% c("2tok", "10", "50", "100", "200"), dataset %in% c("oldpair_50entry", "newpair_100entry")) %>%
pivot_wider(id_cols = c("test", "dataset", "context_char"), names_from = parameter, values_from = stat) %>% group_by(dataset) %>%
mutate(significance = p<0.05) %>%
ggplot(aes(x = context_char, y = beta, color = dataset, group = dataset, shape = significance)) +
geom_point(size = 4) + geom_line() +
scale_shape_manual(values = c(1, 16)) + theme_bw() +
scale_x_discrete(limits = c("2tok", "10", "50", "100", "200")) +
geom_hline(yintercept = 0) + labs(x = "Context size", y = "Effect size")
setwd("/Users/yanting/Desktop/word_length/scripts")
library(tidyverse)
library(dplyr)
library(showtext)
showtext_auto()
library(lme4)
library(lmerTest)
library(ggplot2)
library(poolr)
library(ggrepel)
load_data <- function(file) {
logprob <- read_delim(file, locale=locale(encoding="UTF-8"),
col_names = c("target_word",
"concept",
"word_form",
"target_word_logprob",
"disj_logprob",
"line_num"))
logprob$line_num <- as.factor(logprob$line_num)
logprob$word_form <- as.factor(logprob$word_form)
return(logprob)
}
data <- load_data("/Users/yanting/Desktop/word_length/probs/prob_linenewpair200.csv")
data %>% group_by(target_word, concept, word_form) %>% summarize(disj_logprob=mean(disj_logprob), target_word_logprob=mean(target_word_logprob)) %>%
ungroup() %>% select(-target_word, -target_word_logprob) %>% spread(word_form, disj_logprob)
# means = data %>% group_by(target_word, concept, word_form) %>% summarize(disj_logprob=mean(disj_logprob), target_word_logprob=mean(target_word_logprob)) %>% ungroup()
# using this can directly change logprob to surprisal
means = data %>% group_by(target_word, concept, word_form) %>% summarize(concept_surprisal=-mean(disj_logprob), target_word_surprisal=-mean(target_word_logprob)) %>% ungroup()
t_test_data <- means %>% select(-target_word, -target_word_surprisal) %>% spread(word_form, concept_surprisal)
t.test(t_test_data$long, t_test_data$short, paired = TRUE)
mean(t_test_data$long)
mean(t_test_data$short)
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = 1.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -1.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -1, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = 1.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + theme(axis.ticks.x=element_blank(), axis.text.x=element_blank(), plot.margin=margin(t=20, r=unit(1.5, "in"), b=20, l=20)) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + theme(axis.ticks.x=element_blank(), axis.text.x=element_blank(), plot.margin=margin(t=20, r=unit(3.5, "in"), b=20, l=20)) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + theme(axis.ticks.x=element_blank(), axis.text.x=element_blank(), plot.margin=margin(t=20, r=unit(8, "in"), b=25, l=20)) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + theme(axis.ticks.x=element_blank(), axis.text.x=element_blank(), plot.margin=margin(t=20, r=unit(24, "in"), b=30, l=20)) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + theme(axis.ticks.x=element_blank(), axis.text.x=element_blank(), plot.margin=margin(t=20, r=unit(100, "in"), b=30, l=20)) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
disj <- data %>% select(-target_word, -target_word_logprob, -line_num) %>% mutate(surprisal = -disj_logprob) %>% mutate(is_short = ifelse(word_form == 'short', 0, 1))
disj$word_form <- as.factor(disj$word_form)
mixed_ml2 <- glmer(is_short ~ 1 + surprisal + (1 + surprisal|concept), data = disj, family = binomial)
summary(mixed_ml2)
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + theme(axis.ticks.x=element_blank(), axis.text.x=element_blank(), axis.line.x=element_line(size = 1, colour = "black")) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + theme(axis.ticks.x=element_blank(), axis.text.x=element_blank(), axis.line.x=element_line(size = 1)) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>% filter(above_zero == TRUE)
plotdata = means %>% select(-target_word, -target_word_surprisal) %>% spread(word_form, concept_surprisal) %>% mutate(diff= long-short) %>% select(-short, -long) %>% inner_join(means)
ggplot(plotdata, aes(x=word_form, y=concept_surprisal, label=target_word, group=concept)) + geom_line(aes(color = diff)) + geom_text(alpha = 0.5) +
theme_classic() + scale_color_gradient2(low = "red", high = "blue") + labs(x="\nWord Form", y="Concept Surprisal (nats)\n", color="Surprisal\nDifference")
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + expand_limits(x= c(max(t_test_data$long - t_test_data$short)+2, NA)) +
theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + expand_limits(x= c(max(t_test_data$long - t_test_data$short) + 9, NA)) +
theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + expand_limits(x= c(max(t_test_data$long - t_test_data$short) + 9, NA)) +
theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + coord_cartesian(xlim = c(min(t_test_data$long - t_test_data$short), max(t_test_data$long - t_test_data$short) + 5))
theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + coord_cartesian(xlim = c(min(t_test_data$long - t_test_data$short), max(t_test_data$long - t_test_data$short) + 5)) +
theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + coord_cartesian(xlim = c(min(t_test_data$long - t_test_data$short), max(t_test_data$long - t_test_data$short) + 1)) +
theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + coord_cartesian(xlim = c(min(t_test_data$long - t_test_data$short), max(t_test_data$long - t_test_data$short) + 100)) +
theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + coord_cartesian(xlim = c(min(t_test_data$long - t_test_data$short), max(t_test_data$long - t_test_data$short) + 0.5)) +
theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) +   scale_x_discrete(expand = c(0.1, 0)) +
theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) +   scale_x_discrete(expand = c(0.05, 0)) +
theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) +   scale_x_discrete(expand = c(0.08, 0)) +
theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) +   scale_x_discrete(expand = c(0.03, 0)) +
theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = -0.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) +   scale_x_discrete(expand = c(0.05, 0)) +
theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = 1.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) +   scale_x_discrete(expand = c(0.05, 0)) +
theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = 1.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) +   scale_x_discrete(expand = c(0.08, 0)) +
theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = 1.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) +   scale_x_discrete(expand = c(0.05, 0.05)) +
theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = 1.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + scale_x_discrete(expand = c(0.05, 0.05)) + scale_y_discrete(expand = c(0, 0.05)) +
theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = 1.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + scale_x_discrete(expand = c(0.05, 0.05)) + scale_y_discrete(expand = c(0.05, 0)) +
theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = 1.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + scale_x_discrete(expand = c(0.05, 0.05)) + scale_y_discrete(expand = c(0.1, 0)) +
theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
t_test_data %>% mutate(above_zero = (long - short)>0) %>%
ggplot(aes(x=reorder(concept, (long - short), mean), y= long - short, label = concept, color=above_zero)) +
geom_point(size=3) + geom_text(angle = -45, hjust = 1.5, size = 3) + theme_classic() + labs(y="Difference in surprisal", x = 'Concept') +
geom_hline(yintercept = 0) + scale_x_discrete(expand = c(0.05, 0.05)) + scale_y_discrete(expand = c(0.13, 0)) +
theme(axis.ticks.x=element_blank(), axis.text.x=element_blank()) + guides(color=F) + scale_color_manual(values=c("red","blue" ))
subconcept <- data %>% select(-target_word, -target_word_logprob, -line_num)
sub_short <- subconcept %>% filter(word_form == 'short') %>% rename(short_disj = disj_logprob) %>% select(-word_form) %>% mutate(row = row_number())
sub_long <- subconcept %>% filter(word_form == 'long') %>% rename(long_disj = disj_logprob)%>% select(-word_form, -concept) %>% mutate(row = row_number())
combined <- full_join(sub_short, sub_long, by = "row")
t.test(combined$short_disj, combined$long_disj)
groups <- unique(data$concept)
ps <- data.frame(concept=unlist(groups))
pvalue <- c()
test_stats <- c()
for (i in 1:length(groups)) {
group <- groups[i]
subdata <- subset(data, concept == group)
p_value <- t.test(disj_logprob ~ word_form, data=subdata)$p.value
t <- t.test(disj_logprob ~ word_form, data=subdata)[[1]]
pvalue <- append(pvalue, p_value)
test_stats <- append(test_stats, t )
}
ps$p_value <- unlist(pvalue)
ps$test_stats <- unlist(test_stats)
ps %>% filter(p_value < 0.05)
subconcept <- data %>% select(-target_word, -target_word_logprob, -line_num)
sub_short <- subconcept %>% filter(word_form == 'short') %>% rename(short_disj = disj_logprob) %>% select(-word_form) %>% mutate(row = row_number())
sub_long <- subconcept %>% filter(word_form == 'long') %>% rename(long_disj = disj_logprob)%>% select(-word_form, -concept) %>% mutate(row = row_number())
combined <- full_join(sub_short, sub_long, by = "row")
t.test(combined$short_disj, combined$long_disj)
groups <- unique(data$concept)
ps <- data.frame(concept=unlist(groups))
pvalue <- c()
test_stats <- c()
for (i in 1:length(groups)) {
group <- groups[i]
subdata <- subset(data, concept == group)
p_value <- t.test(disj_logprob ~ word_form, data=subdata)$p.value
t <- t.test(disj_logprob ~ word_form, data=subdata)[[1]]
pvalue <- append(pvalue, p_value)
test_stats <- append(test_stats, t )
}
ps$p_value <- unlist(pvalue)
ps$test_stats <- unlist(test_stats)
ps %>% filter(p_value < 0.05)
ps %>% filter(p_value < 0.05 & test_stats < 0)
data <- load_data("/Users/yanting/Desktop/word_length/probs/prob_linenewpair2tok.csv")
data %>% group_by(target_word, concept, word_form) %>% summarize(disj_logprob=mean(disj_logprob), target_word_logprob=mean(target_word_logprob)) %>%
ungroup() %>% select(-target_word, -target_word_logprob) %>% spread(word_form, disj_logprob)
# means = data %>% group_by(target_word, concept, word_form) %>% summarize(disj_logprob=mean(disj_logprob), target_word_logprob=mean(target_word_logprob)) %>% ungroup()
# using this can directly change logprob to surprisal
means = data %>% group_by(target_word, concept, word_form) %>% summarize(concept_surprisal=-mean(disj_logprob), target_word_surprisal=-mean(target_word_logprob)) %>% ungroup()
t_test_data <- means %>% select(-target_word, -target_word_surprisal) %>% spread(word_form, concept_surprisal)
t.test(t_test_data$long, t_test_data$short, paired = TRUE)
disj <- data %>% select(-target_word, -target_word_logprob, -line_num) %>% mutate(surprisal = -disj_logprob) %>% mutate(is_short = ifelse(word_form == 'short', 0, 1))
disj$word_form <- as.factor(disj$word_form)
mixed_ml2 <- glmer(is_short ~ 1 + surprisal + (1 + surprisal|concept), data = disj, family = binomial)
summary(mixed_ml2)
library(tidyverse)
library(dplyr)
library(showtext)
showtext_auto()
library(lme4)
library(lmerTest)
library(ggplot2)
library(poolr)
library(ggrepel)
stats <- read.csv(file = "/Users/yanting/Desktop/word_length/probs/stats.csv")
stats$stat <- as.numeric(stats$stat)
stats %>% filter(test == "glmer", parameter %in% c("beta", "p"), context_char %in% c("2tok", "10", "50", "100", "200"), dataset %in% c("oldpair_50entry", "newpair_100entry")) %>%
pivot_wider(id_cols = c("test", "dataset", "context_char"), names_from = parameter, values_from = stat) %>% group_by(dataset) %>%
mutate(significance = p<0.05) %>%
ggplot(aes(x = context_char, y = beta, color = dataset, group = dataset, shape = significance)) +
geom_point(size = 4) + geom_line() +
scale_shape_manual(values = c(1, 16)) + theme_bw() +
scale_x_discrete(limits = c("2tok", "10", "50", "100", "200")) +
geom_hline(yintercept = 0) + labs(x = "Context size", y = "Effect size")
stats %>% filter(test == "glmer", parameter %in% c("beta", "p"), context_char %in% c("2tok", "10", "50", "100", "200"), dataset %in% c("oldpair_50entry", "newpair_100entry")) %>%
pivot_wider(id_cols = c("test", "dataset", "context_char"), names_from = parameter, values_from = stat) %>% group_by(dataset) %>%
mutate(significance = p<0.05) %>%
ggplot(aes(x = context_char, y = beta, color = dataset, group = dataset, shape = significance)) +
geom_point(size = 4) + geom_line() +
scale_shape_manual(values = c(1, 16)) + theme_bw() +
scale_x_discrete(limits = c("2tok", "10", "50", "100", "200")) +
geom_hline(yintercept = 0) + labs(x = "Context size", y = "Effect size") +
scale_color_manual(
name = "dataset",
labels = c("Old Pairs (50 Entries)", "New Pairs (100 Entries)"))
stats %>% filter(test == "glmer", parameter %in% c("beta", "p"), context_char %in% c("2tok", "10", "50", "100", "200"), dataset %in% c("oldpair_50entry", "newpair_100entry")) %>%
pivot_wider(id_cols = c("test", "dataset", "context_char"), names_from = parameter, values_from = stat) %>% group_by(dataset) %>%
mutate(significance = p<0.05) %>%
ggplot(aes(x = context_char, y = beta, color = dataset, group = dataset, shape = significance)) +
geom_point(size = 4) + geom_line() +
scale_shape_manual(values = c(1, 16)) + theme_bw() +
scale_x_discrete(limits = c("2tok", "10", "50", "100", "200")) +
geom_hline(yintercept = 0) + labs(x = "Context size", y = "Effect size") +
scale_color_manual(values = c("oldpair_50entry" = "red", "newpair_100entry" = "blue"),
name = "dataset",
labels = c("Old Pairs (50 Entries)", "New Pairs (100 Entries)"))
stats %>% filter(test == "glmer", parameter %in% c("beta", "p"), context_char %in% c("2tok", "10", "50", "100", "200"), dataset %in% c("oldpair_50entry", "newpair_100entry")) %>%
pivot_wider(id_cols = c("test", "dataset", "context_char"), names_from = parameter, values_from = stat) %>% group_by(dataset) %>%
mutate(significance = p<0.05) %>%
ggplot(aes(x = context_char, y = beta, color = dataset, group = dataset, shape = significance)) +
geom_point(size = 4) + geom_line() +
scale_shape_manual(values = c(1, 16)) + theme_bw() +
scale_x_discrete(limits = c("2tok", "10", "50", "100", "200")) +
geom_hline(yintercept = 0) + labs(x = "Context size", y = "Effect size") +
scale_color_manual(values = c("oldpair_50entry", "newpair_100entry"),
name = "dataset",
labels = c("Old Pairs (50 Entries)", "New Pairs (100 Entries)"))
stats %>% filter(test == "glmer", parameter %in% c("beta", "p"), context_char %in% c("2tok", "10", "50", "100", "200"), dataset %in% c("oldpair_50entry", "newpair_100entry")) %>%
pivot_wider(id_cols = c("test", "dataset", "context_char"), names_from = parameter, values_from = stat) %>% group_by(dataset) %>%
mutate(significance = p<0.05) %>%
ggplot(aes(x = context_char, y = beta, color = dataset, group = dataset, shape = significance)) +
geom_point(size = 4) + geom_line() +
scale_shape_manual(values = c(1, 16)) + theme_bw() +
scale_x_discrete(limits = c("2tok", "10", "50", "100", "200")) +
geom_hline(yintercept = 0) + labs(x = "Context size", y = "Effect size") +
scale_color_manual(name = "dataset",
labels = c("Old Pairs (50 Entries)", "New Pairs (100 Entries)"))
pivot_wider(id_cols = c("test", "dataset", "context_char"), names_from = parameter, values_from = stat) %>% group_by(dataset) %>%
mutate(significance = p<0.05) %>%
ggplot(aes(x = context_char, y = beta, color = dataset, group = dataset, shape = significance)) +
geom_point(size = 4) + geom_line() +
scale_shape_manual(values = c(1, 16)) + theme_bw() +
scale_x_discrete(limits = c("2tok", "10", "50", "100", "200")) +
geom_hline(yintercept = 0) + labs(x = "Context size", y = "Effect size") +
scale_color_manual(values = c("oldpair_50entry" = "green", "newpair_100entry" = "purple"),
name = "dataset",
labels = c("Old Pairs (50 Entries)", "New Pairs (100 Entries)"))
stats %>% filter(test == "glmer", parameter %in% c("beta", "p"), context_char %in% c("2tok", "10", "50", "100", "200"), dataset %in% c("oldpair_50entry", "newpair_100entry")) %>%
pivot_wider(id_cols = c("test", "dataset", "context_char"), names_from = parameter, values_from = stat) %>% group_by(dataset) %>%
mutate(significance = p<0.05) %>%
ggplot(aes(x = context_char, y = beta, color = dataset, group = dataset, shape = significance)) +
geom_point(size = 4) + geom_line() +
scale_shape_manual(values = c(1, 16)) + theme_bw() +
scale_x_discrete(limits = c("2tok", "10", "50", "100", "200")) +
geom_hline(yintercept = 0) + labs(x = "Context size", y = "Effect size") +
scale_color_manual(values = c("oldpair_50entry" = "green", "newpair_100entry" = "purple"),
name = "dataset",
labels = c("Old Pairs (50 Entries)", "New Pairs (100 Entries)"))
stats %>% filter(test == "glmer", parameter %in% c("beta", "p"), context_char %in% c("2tok", "10", "50", "100", "200"), dataset %in% c("oldpair_50entry", "newpair_100entry")) %>%
pivot_wider(id_cols = c("test", "dataset", "context_char"), names_from = parameter, values_from = stat) %>% group_by(dataset) %>%
mutate(significance = p<0.05) %>%
ggplot(aes(x = context_char, y = beta, color = dataset, group = dataset, shape = significance)) +
geom_point(size = 4) + geom_line() +
scale_shape_manual(values = c(1, 16)) + theme_bw() +
scale_x_discrete(limits = c("2tok", "10", "50", "100", "200")) +
geom_hline(yintercept = 0) + labs(x = "Context size", y = "Effect size") +
scale_color_manual(values = c("oldpair_50entry" = "yellow", "newpair_100entry" = "purple"),
name = "dataset",
labels = c("Old Pairs (50 Entries)", "New Pairs (100 Entries)"))
stats %>% filter(test == "glmer", parameter %in% c("beta", "p"), context_char %in% c("2tok", "10", "50", "100", "200"), dataset %in% c("oldpair_50entry", "newpair_100entry")) %>%
pivot_wider(id_cols = c("test", "dataset", "context_char"), names_from = parameter, values_from = stat) %>% group_by(dataset) %>%
mutate(significance = p<0.05) %>%
ggplot(aes(x = context_char, y = beta, color = dataset, group = dataset, shape = significance)) +
geom_point(size = 4) + geom_line() +
scale_shape_manual(values = c(1, 16)) + theme_bw() +
scale_x_discrete(limits = c("2tok", "10", "50", "100", "200")) +
geom_hline(yintercept = 0) + labs(x = "Context size", y = "Effect size") +
scale_color_manual(values = c("oldpair_50entry" = "pink", "newpair_100entry" = "purple"),
name = "dataset",
labels = c("Old Pairs (50 Entries)", "New Pairs (100 Entries)"))
colors()
stats %>% filter(test == "glmer", parameter %in% c("beta", "p"), context_char %in% c("2tok", "10", "50", "100", "200"), dataset %in% c("oldpair_50entry", "newpair_100entry")) %>%
pivot_wider(id_cols = c("test", "dataset", "context_char"), names_from = parameter, values_from = stat) %>% group_by(dataset) %>%
mutate(significance = p<0.05) %>%
ggplot(aes(x = context_char, y = beta, color = dataset, group = dataset, shape = significance)) +
geom_point(size = 4) + geom_line() +
scale_shape_manual(values = c(1, 16)) + theme_bw() +
scale_x_discrete(limits = c("2tok", "10", "50", "100", "200")) +
geom_hline(yintercept = 0) + labs(x = "Context size", y = "Effect size") +
scale_color_manual(values = c("oldpair_50entry" = "rosybrown3", "newpair_100entry" = "purple"),
name = "dataset",
labels = c("Old Pairs (50 Entries)", "New Pairs (100 Entries)"))
stats %>% filter(test == "glmer", parameter %in% c("beta", "p"), context_char %in% c("2tok", "10", "50", "100", "200"), dataset %in% c("oldpair_50entry", "newpair_100entry")) %>%
pivot_wider(id_cols = c("test", "dataset", "context_char"), names_from = parameter, values_from = stat) %>% group_by(dataset) %>%
mutate(significance = p<0.05) %>%
ggplot(aes(x = context_char, y = beta, color = dataset, group = dataset, shape = significance)) +
geom_point(size = 4) + geom_line() +
scale_shape_manual(values = c(1, 16)) + theme_bw() +
scale_x_discrete(limits = c("2tok", "10", "50", "100", "200")) +
geom_hline(yintercept = 0) + labs(x = "Context size", y = "Effect size") +
scale_color_manual(values = c("100pair_100entry" = "rosybrown3", "100pair_50entry" = "purple"),
name = "dataset",
labels = c("Old Pairs (50 Entries)", "New Pairs (100 Entries)"))
stats %>% filter(test == "glmer", parameter %in% c("beta", "p"), context_char %in% c("2tok", "10", "50", "100", "200"), dataset %in% c("oldpair_50entry", "newpair_100entry")) %>%
pivot_wider(id_cols = c("test", "dataset", "context_char"), names_from = parameter, values_from = stat) %>% group_by(dataset) %>%
mutate(significance = p<0.05) %>%
ggplot(aes(x = context_char, y = beta, color = dataset, group = dataset, shape = significance)) +
geom_point(size = 4) + geom_line() +
scale_shape_manual(values = c(1, 16)) + theme_bw() +
scale_x_discrete(limits = c("2tok", "10", "50", "100", "200")) +
geom_hline(yintercept = 0) + labs(x = "Context size", y = "Effect size") +
scale_color_manual(values = c("100pair_50entry" = "rosybrown3", "100pair_100entry" = "purple"),
name = "dataset",
labels = c("100 pairs 50 entries each", "100 pairs 100 entries each"))
stats %>% filter(test == "glmer", parameter %in% c("beta", "p"), context_char %in% c("2tok", "10", "50", "100", "200"), dataset %in% c("oldpair_50entry", "newpair_100entry")) %>%
pivot_wider(id_cols = c("test", "dataset", "context_char"), names_from = parameter, values_from = stat) %>% group_by(dataset) %>%
mutate(significance = p<0.05) %>%
ggplot(aes(x = context_char, y = beta, color = dataset, group = dataset, shape = significance)) +
geom_point(size = 4) + geom_line() +
scale_shape_manual(values = c(1, 16)) + theme_bw() +
scale_x_discrete(limits = c("2tok", "10", "50", "100", "200")) +
geom_hline(yintercept = 0) + labs(x = "Context size", y = "Effect size") +
scale_color_manual(values = c("oldpair_50entry" = "lightsalmon", "newpair_100entry" = "purple"),
name = "dataset",
labels = c("100 pairs, 50 entries each", "100 pairs, 100 entries each"))
stats %>% filter(test == "glmer", parameter %in% c("beta", "p"), context_char %in% c("2tok", "10", "50", "100", "200"), dataset %in% c("oldpair_50entry", "newpair_100entry")) %>%
pivot_wider(id_cols = c("test", "dataset", "context_char"), names_from = parameter, values_from = stat) %>% group_by(dataset) %>%
mutate(significance = p<0.05) %>%
ggplot(aes(x = context_char, y = beta, color = dataset, group = dataset, shape = significance)) +
geom_point(size = 4) + geom_line() +
scale_shape_manual(values = c(1, 16)) + theme_bw() +
scale_x_discrete(limits = c("2tok", "10", "50", "100", "200")) +
geom_hline(yintercept = 0) + labs(x = "Context size", y = "Effect size") +
scale_color_manual(values = c("oldpair_50entry" = "lightsalmon", "newpair_100entry" = "purple"),
name = "dataset",
labels = c("Dataset A 100 entries each", "Dataset B 50 entries each"))
stats %>% filter(test == "glmer", parameter %in% c("beta", "p"), context_char %in% c("2tok", "10", "50", "100", "200"), dataset %in% c("oldpair_50entry", "newpair_100entry")) %>%
pivot_wider(id_cols = c("test", "dataset", "context_char"), names_from = parameter, values_from = stat) %>% group_by(dataset) %>%
mutate(significance = p<0.05) %>%
ggplot(aes(x = context_char, y = beta, color = dataset, group = dataset, shape = significance)) +
geom_point(size = 4) + geom_line() +
scale_shape_manual(values = c(1, 16)) + theme_bw() +
scale_x_discrete(limits = c("2tok", "10", "50", "100", "200")) +
geom_hline(yintercept = 0) + labs(x = "Context Length", y = "Effect Size") +
scale_color_manual(values = c("oldpair_50entry" = "lightsalmon", "newpair_100entry" = "purple"),
name = "dataset",
labels = c("Dataset A 100 entries each", "Dataset B 50 entries each"))
